@page "/FileUpload"

@using System.IO
@using Microsoft.AspNetCore.Components.Forms
@using SHC.Models @* to import the object*@

<Field>
    <InputFile OnChange="@OnFileUpload" accept=".csv" />
</Field>
<button @onclick="Submit">Submit</button>

@code {
    private MemoryStream fileContent;
    private bool fileSelected = false;

    async Task OnFileUpload(InputFileChangeEventArgs e)
    {
        var file = e.File; // Assuming single file, remove Multiple and handle one file
        if (file != null)
        {
            fileContent = new MemoryStream();
            await file.OpenReadStream().CopyToAsync(fileContent);
            fileSelected = true; // Mark as file selected
        }
    }

    void Submit()
    {
        if (fileSelected && fileContent != null)
        {
            fileContent.Position = 0; // Reset the position to read from the beginning
            FileHomeReader fileHomeReader = new FileHomeReader(); // Adjust the constructor as needed
            fileHomeReader.readFile(fileContent); // Adapt readFile to accept MemoryStream or Stream
            fileContent.Dispose(); // Dispose the stream if no longer needed
        }
    }
}
